 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/backend/app/crud.py b/backend/app/crud.py
index 8cab238cbc73ded0528a8f6072e26d8a50e1c5fa..a647a6186ca6ba888dc082d803370e80eff3161c 100644
--- a/backend/app/crud.py
+++ b/backend/app/crud.py
@@ -710,50 +710,54 @@ def generate_monthly_bills(db: Session, month: date):
 def get_provider_fees_due(db: Session, provider_id: int) -> float:
     """
     Amount due for the most recent unpaid bill for this provider, in GYD.
 
     This mirrors the "Total due" shown on the provider-facing bill by:
     - Taking the latest unpaid bill (so we don't aggregate across months),
     - Using only the platform fee amount (fee_gyd), and
     - Applying any available bill credits.
     """
     latest_unpaid_bill = (
         db.query(models.Bill)
         .filter(
             models.Bill.provider_id == provider_id,
             models.Bill.is_paid == False,
         )
         .order_by(models.Bill.due_date.desc())
         .first()
     )
 
     if not latest_unpaid_bill:
         return 0.0
 
     # Billing for providers should only charge the platform fee, not their gross booking revenue.
     total_due = Decimal(str(latest_unpaid_bill.fee_gyd or 0))
     credits = Decimal(str(get_provider_credit_balance(db, provider_id) or 0))
+    # Bill credits should only ever reduce what a provider owes. If the balance is
+    # negative (e.g., from a bad manual entry), clamp it to zero so we don't
+    # accidentally inflate the amount due.
+    credits = max(credits, Decimal("0"))
 
     net_due = total_due - credits
     if net_due < 0:
         net_due = Decimal("0")
 
     return float(net_due)
 
 
 def _provider_billing_row(db: Session, provider: models.Provider, user: models.User):
     amount_due = get_provider_fees_due(db, provider.id)
     latest_bill = (
         db.query(models.Bill)
         .filter(models.Bill.provider_id == provider.id)
         .order_by(models.Bill.due_date.desc())
         .first()
     )
 
     return {
         "provider_id": provider.id,
         "name": user.full_name or "",
         "account_number": provider.account_number or "",
         "phone": user.phone or "",
         "amount_due_gyd": float(amount_due or 0.0),
         "is_paid": amount_due <= 0,
         "last_due_date": latest_bill.due_date if latest_bill else None,
 
EOF
)